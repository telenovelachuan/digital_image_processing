%footBall=imread('noiseball.png');
footBall=imread('space.tif');
imshow(footBall);

%Determine good padding for Fourier transform
PQ = paddedsize(size(footBall));
D0 = 0.05*PQ(1);
d_options = [0.01 0.03 0.05 2];
results = {};
for idx = 1:numel(d_options)
   ratio = d_options(idx);
   D0 = ratio * PQ(1);
   H = lpfilter('btw', PQ(1), PQ(2), D0); 
   F=fft2(double(footBall),PQ(1),PQ(2));
   lp = H.*F;
   spatial=real(ifft2(lp)); 
end


% Apply the notch filters to the Fourier spectrum of the image
%FS_football = F.*H1.*H2.*H3.*H4.*H5.*H6;
%FS_football = F.*H1.*H2.*H3.*H4.*H5.*H6;

% convert the result to the spacial domain.
F_football=real(ifft2(FS_football)); 

% Crop the image to undo padding
F_football=F_football(1:size(footBall,1), 1:size(footBall,2));

%Display the blurred image
figure, imshow(F_football,[])

% Display the Fourier Spectrum 
% Move the origin of the transform to the center of the frequency rectangle.
Fc=fftshift(F);
Fcf=fftshift(FS_football);

% use abs to compute the magnitude and use log to brighten display
S1=log(1+abs(Fc)); 
S2=log(1+abs(Fcf));
figure, imshow(S1,[])
figure, imshow(S2,[])

